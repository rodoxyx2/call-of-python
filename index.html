<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>Call-Of-Python</title>
<style>
  body{font-family:Arial;margin:0;display:flex;background:#120007;color:#fff;height:100vh;}
  #sidebar{width:260px;background:#2b0010;padding:18px;height:100vh;overflow:auto;border-right:3px solid #ff002b}
  #sidebar h2{color:#ff003c;margin:0 0 10px;font-size:22px}
  .mission-title{margin-top:18px;color:#ff8aa3;font-weight:700;font-size:18px}
  .sublevel-title{margin-left:10px;margin-top:10px;color:#fcb3c4;font-size:15px}
  .level{margin:6px 0 6px 18px;padding:8px;background:#3d0016;border-left:4px solid #ff003c;cursor:pointer;border-radius:4px;font-size:14px}
  .locked{opacity:.35;pointer-events:none}

  #content{flex:1;padding:20px;overflow:auto}
  textarea{width:95%;height:150px;background:#000;color:#0ff;padding:10px;border:2px solid #ff003c;border-radius:6px;font-family:monospace}
  button{margin-top:10px;padding:10px 16px;background:#ff003c;border:none;color:#fff;border-radius:6px;cursor:pointer;font-weight:700}
  #msg{margin-top:14px;padding:10px;border-radius:6px}
  pre.example{background:#0f0f0f;padding:10px;color:#9efff3;border-radius:6px}

  #pyshotOverlay{position:fixed;left:0;top:0;width:100%;height:100%;display:none;
    background:rgba(0,0,0,.8);z-index:50;align-items:center;justify-content:center}
  #pyshotOverlay h1{font-size:72px;color:#ff3030;text-shadow:0 0 30px #ff3030;transform:scale(0);animation:pop .5s forwards}
  @keyframes pop{to{transform:scale(1)}}
</style>
</head>
<body>

<div id="sidebar">
  <h2>CALL-OF-PYTHON</h2>

  <div class="mission-title">INTRODUCCIÓN</div>
  <div class="level" id="introBtn" onclick="loadLevel('intro')" data-id="intro">¿Qué es Python?</div>

  <!-- Misión 1 -->
  <div class="mission-title">MISIÓN 1: Fundamentos</div>
  <div class="sublevel-title">Básico</div>
    <div class="level" data-id="1a" onclick="loadLevel('1a')">Variables</div>
    <div class="level locked" data-id="1b" onclick="loadLevel('1b')">Strings</div>
  <div class="sublevel-title">Intermedio</div>
    <div class="level locked" data-id="1c" onclick="loadLevel('1c')">Concatenación</div>

  <!-- Misión 2 -->
  <div class="mission-title">MISIÓN 2: Condiciones</div>
  <div class="sublevel-title">Básico</div>
    <div class="level locked" data-id="2a" onclick="loadLevel('2a')">If simple</div>
  <div class="sublevel-title">Intermedio</div>
    <div class="level locked" data-id="2b" onclick="loadLevel('2b')">If + Else</div>
  <div class="sublevel-title">Avanzado</div>
    <div class="level locked" data-id="2c" onclick="loadLevel('2c')">If anidados</div>
</div>

<div id="content">
  <h1 id="title"></h1>
  <p id="desc"></p>

  <h3>Ejemplo:</h3>
  <pre id="example" class="example">—</pre>

  <div id="exerciseArea" style="display:none">
    <textarea id="code" placeholder="# Escribe tu código aquí..."></textarea><br>
    <button id="runBtn" onclick="runLevel()">Ejecutar</button>
  </div>

  <div id="msg"></div>
</div>

<div id="pyshotOverlay"><h1>PYSHOT</h1></div>

<script>
// ----------------- Niveles (TODOS los que ya tenías + organizados por misión) -----------------
const levels = {
  intro: {
    title: "Introducción a Python",
    desc: "Python es un lenguaje de programación fácil de leer, usado en ciencia de datos, inteligencia artificial y automatización.",
    example: `print("Bienvenido a Call-Of-Python")`
  },

  // Misión 1 – Básico
  "1a": {
    title: "Variables",
    desc: "Declara una variable x con valor 10.",
    example:`x = 10\nprint(x)`,
    check:/x\s*=\s*10/
  },
  "1b": {
    title: "Strings",
    desc: "Crea una variable nombre con tu nombre.",
    example:`nombre = "Rodi"\nprint(nombre)`,
    check:/nombre\s*=\s*["'].*["']/
  },

  // Misión 1 – Intermedio
  "1c": {
    title:"Concatenación",
    desc:"Usa print para imprimir Hola + nombre.",
    example:`nombre = "Ana"\nprint("Hola " + nombre)`,
    check:/print\s*\(\s*["']Hola\s*["']\s*\+\s*nombre\s*\)/
  },

  // Misión 2 – Básico
  "2a": {
    title:"If simple",
    desc:"Escribe un if que imprima 'Mayor' si número > 10.",
    example:`numero = 15\nif numero > 10:\n    print("Mayor")`,
    check:/if\s+.*>\s*10\s*:/
  },

  // Misión 2 – Intermedio
  "2b": {
    title:"If + Else",
    desc:"If que imprima 'Mayor' o 'No es mayor'.",
    example:`numero = 5\nif numero > 10:\n    print("Mayor")\nelse:\n    print("No es mayor")`,
    check:/else\s*:/
  },

  // Misión 2 – Avanzado
  "2c": {
    title:"If anidado",
    desc:"Crea un if dentro de otro if.",
    example:`edad = 18\nif edad >= 18:\n    if edad < 30:\n        print("Joven adulto")`,
    check:/if\s+edad.*\n\s*if/
  }
};

// -------------- Estado --------------
let currentLevel = null;
let unlockedList = ["intro","1a"]; // ya Intro + primer nivel

const exampleEl = document.getElementById("example");
const titleEl = document.getElementById("title");
const descEl = document.getElementById("desc");
const exerciseArea = document.getElementById("exerciseArea");
const msgEl = document.getElementById("msg");
const pyshot = document.getElementById("pyshotOverlay");

// -------------- Cargar nivel --------------
function loadLevel(id){
  currentLevel=id;
  const lvl=levels[id];
  titleEl.textContent=lvl.title;
  descEl.textContent=lvl.desc;
  exampleEl.textContent=lvl.example;
  msgEl.textContent="";

  if(lvl.check){
    exerciseArea.style.display="block";
    document.getElementById("code").value="";
  } else {
    exerciseArea.style.display="none";
  }
}

// -------------- Funciones originales restauradas --------------
function success(message){
  msgEl.style.background="#003b12";
  msgEl.textContent="¡Py-SHOT! Nivel completado. "+(message||"");

  pyshot.style.display="flex";
  setTimeout(()=>pyshot.style.display="none",1200);

  unlockNext();
}

function fail(message){
  msgEl.style.background="#3b0000";
  msgEl.textContent="Error. "+(message||"Revisa el ejemplo.");
}

function unlockNext(){
  const order = Object.keys(levels);  
  const idx = order.indexOf(currentLevel);
  if(idx>=0 && idx<order.length-1){
    const next = order[idx+1];
    unlockedList.push(next);
    const el=document.querySelector(`[data-id='${next}']`);
    if(el) el.classList.remove("locked");
  }
}

// -------------- Ejecutar nivel --------------
function runLevel(){
  const lvl=levels[currentLevel];
  if(!lvl.check) return;
  const code=document.getElementById("code").value;
  try{
    lvl.check.test(code) ? success() : fail("Código inválido.");
  }catch{
    fail("Error en validación.");
  }
}

// -------------- Inicializar --------------
document.querySelectorAll(".level").forEach(el=>{
  if(!unlockedList.includes(el.dataset.id)) el.classList.add("locked");
});

loadLevel("intro");
</script>
</body>
</html>
